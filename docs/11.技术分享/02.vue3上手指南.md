---
title: è¶…æé€Ÿçš„Vue3ä¸Šæ‰‹æŒ‡åŒ—ğŸ”¥
sidebar: auto
date: 2022-06-11 00:00:00
# sticky: true
tags:
  - æ˜é‡‘åˆ†äº«
categories:
  - vue
permalink: /pages/45a4597f46504/
---

<p align="center">
  <img width="500" src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fdd2f2cdffc14bcd9be6f5ae460c5c03~tplv-k3u1fbpfcp-zoom-crop-mark:3024:3024:3024:1702.awebp?"/>
</p>

> ç¬”è€…ä¹‹å‰æ˜¯ Vue2+React å¼€å‘è€…ï¼Œå› é¡¹ç›®éœ€è¦ç›´æ¥ä¸Šæ‰‹ Vue3ï¼Œæ‰€ä»¥å¿«é€Ÿå­¦ä¹ ä¸€ä¸‹ï¼Œä¸­é—´ä¼šå¯¹æ¯”ä¸€äº›å’Œ React ç›¸å…³çš„åŒºåˆ«

<!-- more -->

## ä¸€ã€å‰è¨€

ç¬”è€…ä¹‹å‰æ˜¯ Vue2+React å¼€å‘è€…ï¼Œå› é¡¹ç›®éœ€è¦ç›´æ¥ä¸Šæ‰‹ Vue3ï¼Œæ‰€ä»¥å¿«é€Ÿå­¦ä¹ ä¸€ä¸‹ï¼Œä¸­é—´ä¼šå¯¹æ¯”ä¸€äº›å’Œ React ç›¸å…³çš„åŒºåˆ«ã€‚é˜…è¯»å‰æï¼š`å·²ç»ä¸Šæ‰‹äº†Vue2çš„å¼€å‘`ï¼Œæœ¬æ–‡ä¸»è¦èŠçš„é—®é¢˜ï¼š

- Vue3 çš„å…¨æ–°ç‰¹æ€§
- Vue2 å’Œ Vue3 çš„ä¸€äº›åŒºåˆ«
- Vue2 å¼€å‘è€…å¦‚ä½•å¿«é€Ÿä¸Šæ‰‹ Vue3
- Vue3 å’Œ React çš„ç®€å•æ¯”å¯¹
- ä½¿ç”¨ Vue3 ç¼–å†™ç»„ä»¶åº“
- åç»­å…³äº Vue3 çš„ä¸€äº›å­¦ä¹ ã€æºç ã€é¢è¯•é¢˜ç­‰

> [ã€ä¿ŠåŠ«çš„å­¦ä¹ åŸºåœ°ã€‘ æ›´å¤šå‰ç«¯å­¦ä¹ èµ„æºç­‰ä½ æ¥æ‹¿](https://alexwjj.github.io/)ï¼ˆæœ‰æ‘¸é±¼ç¾¤ ğŸ³ï¼‰ï¼Œ
>
> [ç‚¹å‡»å…³æ³¨å…¬ä¼—å·](https://alexwjj.github.io/img/wx-global.png)ï¼Œä¸€èµ·å­¦ä¹ æ‰“å¡ï¼å…„å¼Ÿå§å¦¹å¸®å°å¼Ÿç‚¹ä¸ªèµ
>
> å¼ºçƒˆæ¨è[å°æ»¡ ZS çš„ B ç«™æ•™ç¨‹ï¼šVue3 + vite + Ts + pinia + å®æˆ˜ + æºç  +å…¨æ ˆ](https://www.bilibili.com/video/BV1dS4y1y7vd?p=1)

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d8a46185ae944fc3bdef826827660396~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?)

## äºŒã€Vue2 vs Vue3

### 2.1 ç®€å•ç‚¹è¯´

- Vue2 åªæ”¯æŒ`å•èŠ‚ç‚¹`ï¼ŒVue3 template æ”¯æŒ`å¤šèŠ‚ç‚¹`ï¼Œç±»ä¼¼ react fragments
- `å˜åŒ–`åŸºæœ¬éƒ½åœ¨ script ä¸­ï¼ˆOption api -> Composition apiï¼‰ä¸ä¼šå†çœ‹è§æ»¡å±çš„ this äº†ï¼ï¼ï¼
- style æ”¯æŒ`v-bind`
- Proxy ä»£æ›¿ defineProperty
  - defineProperty æ— æ³•å®ç°å¯¹æ•°ç»„å¯¹è±¡çš„æ·±å±‚ç›‘å¬ï¼Œ`Proxy`æ˜¯æµè§ˆå™¨æœ€æ–° apiï¼ŒåŠŸèƒ½æ›´åŠ å¼ºå¤§ã€‚
  - ä¸å†æ”¯æŒ IEï¼ŒVue2 æƒ³äº«å— Vue3 å¸¦æ¥çš„éƒ¨åˆ†æ›´æ–°ï¼Œå¯è€ƒè™‘å‡çº§`Vue2.7`ç‰ˆæœ¬
- TypeScript çš„æ”¯æŒ
  - Vue2 é‡‡ç”¨çš„æ˜¯ Facebook çš„`Flow`ï¼Œæ²¡æ³•å®Œç¾æ”¯æŒ`TypeScript`ï¼ˆæ‰€ä»¥é¡¹ç›®åˆæœŸæŠ€æœ¯é€‰å‹å¾ˆé‡è¦ï¼‰
  - Vue3 TypeScript`å®Œå…¨é‡å†™`ï¼Œæä¾›å’Œ React ä¸€æ ·çš„ TS æ”¯æŒ
- å…¨æ–°ç”Ÿæ€
  - åŸºæœ¬è¿˜æ˜¯ vue å‘¨è¾¹ä¼´éš Vue3 å‡çº§é‚£ä¸€å¥—ï¼Œä½†æ˜¯çŠ¶æ€ç®¡ç†æ¨èï¼Œç”±åŸæ¥çš„ Vuex å˜ä¸º`Pina`
  - å…¨æ–°çš„`vite`æ”¯æŒï¼ŒåŒ…æ‹¬`vitest`ç­‰ï¼Œå®˜æ–¹æä¾›å‘¨è¾¹å·¥å…·æ›´å¤šäº†
- å…¶å®ƒä¼˜åŒ–
  - `æ€§èƒ½æ›´å¥½ï¼Œä½“ç§¯æ›´å°`å°±ä¸ç”¨è¯´äº†
  - `äº‹ä»¶ç›‘å¬ç¼“å­˜`ï¼Œç±»ä¼¼@click ç»‘å®šçš„å‡½æ•°ï¼Œæ— éœ€å¤šæ¬¡åˆ›å»ºï¼Œæ”¾åœ¨äº† cacheHandler ç¼“å­˜ä¸­
  - `SSR`ï¼šVue 3.0 ä¼šå°†é™æ€æ ‡ç­¾ç›´æ¥è½¬åŒ–ä¸ºæ–‡æœ¬ï¼Œç›¸æ¯” React å…ˆå°† JSX è½¬åŒ–ä¸ºè™šæ‹Ÿ DOMï¼Œå†å°†è™šæ‹Ÿ DOM è½¬åŒ–ä¸º HTMLï¼Œè¿™ä¸€ç‚¹ Vue3 çš„é€Ÿåº¦è¦å¿«å¾ˆå¤š
  - `Use Hooks` æ”¾å¼ƒè¿‡å»çš„ mixinsï¼Œä½¿ç”¨ Hooks è§£å†³è¿‡å» mixins çš„ä¸€äº›ç¼ºç‚¹
-

### 2.2 æºç 

> äº†è§£çš„ä¸å¤šï¼Œåç»­å†è¡¥å……

#### diff ç®—æ³•çš„ä¼˜åŒ–

- ä¸å†å’Œ vue2 ä¸€æ ·ï¼Œå®Œå…¨å¯¹æ¯”ä¸¤æ£µè™šæ‹Ÿ DOM æ ‘ï¼ŒVue3 é‡‡ç”¨`åŠ¨é™ç»“åˆ`çš„æ–¹æ³•ï¼Œä¼˜åŒ– diff æ€§èƒ½
- é€šè¿‡ç¼–è¯‘é˜¶æ®µå¯¹é™æ€æ¨¡æ¿è¿›è¡Œåˆ†æï¼Œç¼–è¯‘ç”Ÿæˆ Block treeã€‚æ›´æ–°æ€§èƒ½ç”± `æ¨¡ç‰ˆæ•´ä½“å¤§å°ç›¸å…³` =ã€‹ä¸`åŠ¨æ€å†…å®¹çš„æ•°é‡ç›¸å…³`ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ€§èƒ½çªç ´ã€‚å°†ä»£ç æå‡åˆ°æ¸²æŸ“å‡½æ•°ä¹‹å¤–ï¼Œè¿™æ ·å¯ä»¥é¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡æ–°åˆ›å»ºè¿™äº›å¯¹è±¡ï¼Œä»è€Œå¤§å¤§æé«˜å†…å­˜ä½¿ç”¨ç‡å¹¶å‡å°‘åƒåœ¾å›æ”¶çš„é¢‘ç‡ã€‚

#### æºç ç®¡ç†

- vue2 `poly-repo`
  - vue2.x çš„æºç æ‰˜ç®¡åœ¨ src ç›®å½•ä¸­ï¼Œç„¶åä¾æ®åŠŸèƒ½æ‹†åˆ†å‡ºäº† complier(æ¨¡æ¿ç¼–è¯‘çš„ç›¸å…³ä»£ç )ï¼Œcore(ä¸å¹³å°æ— å…³çš„é€šç”¨è¿è¡Œæ—¶ä»£ç )ï¼Œplatforms(å¹³å°ä¸“æœ‰ä»£ç )ï¼Œserverï¼ˆæœåŠ¡ç«¯æ¸²æŸ“çš„ç›¸å…³ä»£ç ï¼‰ã€sfcï¼ˆ.vue å•æ–‡ä»¶è§£æç›¸å…³ä»£ç ï¼‰ã€sharedï¼ˆå…±äº«å·¥å…·ä»£ç ï¼‰ ç­‰ç›®å½•
- vue3 `mono-repo`
  - package å¯ä»¥`ç‹¬ç«‹äº`vue.js å»ä½¿ç”¨ï¼Œè¿™æ ·ä¾‹å¦‚ç”¨æˆ·æƒ³è¦ä½¿ç”¨ vue3.0 çš„å“åº”å¼ï¼Œå¯ä»¥`å•ç‹¬ä¾èµ–reactive`ï¼Œè€Œä¸å¿…ä¾èµ–æ•´ä¸ª vue.jsï¼Œå‡å°‘å¼•ç”¨åŒ…çš„ä½“ç§¯ï¼Œè€Œ vue2.x å´åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚
- æºç ç»“æ„å¯¹æ¯”
  ![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dc103a05a49a462ca125bf62ab95e0c8~tplv-k3u1fbpfcp-watermark.image?)

## ä¸‰ã€å…¨æ–°çš„ API

[ä»€ä¹ˆæ˜¯ç»„åˆå¼ APIï¼Ÿ- Vue å®˜æ–¹](https://v3.cn.vuejs.org/guide/composition-api-introduction.html#%E4%BB%80%E4%B9%88%E6%98%AF%E7%BB%84%E5%90%88%E5%BC%8F-api)

- è§£å†³äº†è¿‡å»ç»„ä»¶è¿‡é•¿æ—¶ï¼ŒoptionsApi å¸¦æ¥çš„éš¾ä»¥ç»´æŠ¤çš„é—®é¢˜
- é€»è¾‘å¯ä»¥æ•´å—å¤ç”¨
- æ‰€æœ‰ API éƒ½æ˜¯ import å¼•å…¥çš„ï¼Œå¯¹ Tree- shaking å¾ˆå‹å¥½ï¼Œæ²¡ç”¨åˆ°åŠŸèƒ½ï¼Œæ‰“åŒ…çš„æ—¶å€™ä¼šè¢«æ¸…ç†æ‰ï¼Œå‡å°åŒ…çš„å¤§å°

### 3.1 setup

- æ–°çš„ Â `setup`Â  é€‰é¡¹åœ¨ç»„ä»¶è¢«åˆ›å»º**ä¹‹å‰**æ‰§è¡Œï¼Œä¸€æ—¦ Â `props`Â  è¢«è§£æå®Œæˆï¼Œå®ƒå°±å°†è¢«ä½œä¸ºç»„åˆå¼ API çš„å…¥å£ã€‚
- å¯ä»¥å½“åš Vue2 çš„ beforeCreate å’Œ create ç”Ÿå‘½å‘¨æœŸç”¨
- å¯ç›´æ¥å†™`awaitè¯­æ³•`
- SFC å•æ–‡ä»¶ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨`<script lang="ts" setup>`å³å¯ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç»“åˆ`export default`ä½¿ç”¨

```js
<script lang="ts" setup>
  const result = await Http.get('/getUserInfo')
</script>;
// or
export default {
  setup(props, context) {
    // Attribute (éå“åº”å¼å¯¹è±¡ï¼Œç­‰åŒäº $attrs)
    console.log(context.attrs);
    // æ’æ§½ (éå“åº”å¼å¯¹è±¡ï¼Œç­‰åŒäº $slots)
    console.log(context.slots);
    // è§¦å‘äº‹ä»¶ (æ–¹æ³•ï¼Œç­‰åŒäº $emit)
    console.log(context.emit);
    // æš´éœ²å…¬å…± property (å‡½æ•°)
    console.log(context.expose);
  },
};
```

### 3.2 ref

- ref ç”¨æ¥åˆ›å»º`åŸºç¡€ç±»å‹`çš„å“åº”å¼æ•°æ®
- template ä¸­é»˜è®¤è°ƒç”¨ value æ˜¾ç¤ºæ•°æ®ï¼Œscript ä¸­éœ€è¦ä½¿ç”¨`.value` è°ƒç”¨
- å’Œ react ref å·®ä¸å¤šï¼Œreact æ˜¯.current è·å–å€¼ï¼Œvue3 æ˜¯.valueã€‚
- Ref çš„æœ¬è´¨æ˜¯é€šè¿‡ Reactive åˆ›å»ºçš„ï¼ŒRef(10)=>Reactive({value:10})

> æœ‰ä¸€å®šçš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œå°¤å¤§ä¹Ÿæ˜ç¡®è¯´äº†ä¸ä¼šæ”¯æŒ script ä¸­ç›´æ¥è®¿é—®ã€‚ç©¶å…¶åŸå› ï¼Œè¿˜æ˜¯åŸºç¡€ç±»å‹æ— æ³•æ‹¦æˆªå®ƒçš„å˜åŒ–ï¼Œå½“ç„¶ä¹Ÿæœ‰å¤§å“¥æå‡ºç”¨ new String('foo')ç±»ä¼¼çš„è¯­æ³•å¯¹åŸºç¡€ç±»å‹è¿›è¡ŒåŒ…è£…ã€‚ä¸ªäººæ„Ÿè§‰ç›´æ¥æ‹¿å·²æ”¯æŒçš„ reactive æ¥æä¹Ÿä¸é”™

#### ç›¸å…³ api

- `Ref` ts å®šä¹‰ `import { type Ref } from 'vue';`
- `isRef` åˆ¤æ–­æ˜¯å¦ä¸º ref å¯¹è±¡ã€‚ä¸€èˆ¬æ˜¯ refï¼ŒtoRefï¼ŒtoRefs åˆ›å»ºçš„å˜é‡
- `toRefs` å°†`reactiveå¯¹è±¡`è§£æ„ä¸ºå•ä¸ªå“åº”å¼å¯¹è±¡
- `shallowRef` åˆ›å»ºä¸€ä¸ªè·Ÿè¸ªè‡ªèº« Â .valueÂ  å˜åŒ–çš„ refï¼Œä½†ä¸ä¼šä½¿å…¶å€¼ä¹Ÿå˜æˆå“åº”å¼çš„ï¼Œç®€å•ç†è§£ä¸ºåˆ›å»ºä¸€ä¸ªå’Œ ref ç›¸åŒç»“æ„çš„éå“åº”å¼å˜é‡
- `triggerRef` å¼ºåˆ¶æ›´æ–°é¡µé¢ DOMã€‚å³ä½¿åˆ›å»ºçš„ ref æ²¡æœ‰å˜ï¼Œæƒ³æ›´æ–° dom å¯ä»¥ç”¨
- `customRef` æä¾›ç±»ä¼¼äº computed çš„ get å’Œ setï¼Œå¯è‡ªå®šä¹‰ ref è¡Œä¸º

### 3.3 reactive

- reactive ç”¨æ¥åˆ›å»º`å¼•ç”¨ç±»å‹`çš„å“åº”å¼æ•°æ®
- reactive çš„æœ¬è´¨æ˜¯å°†æ¯ä¸€å±‚çš„æ•°æ®éƒ½è§£ææˆ`proxyå¯¹è±¡`
- reactive çš„å“åº”å¼é»˜è®¤éƒ½æ˜¯`é€’å½’çš„`ï¼Œæ”¹å˜æŸä¸€å±‚çš„å€¼éƒ½ä¼šé€’å½’çš„è°ƒç”¨ä¸€éï¼Œé‡æ–°æ¸²æŸ“ domã€‚
- `ç›´æ¥è§£æ„`ï¼Œå“åº”æ€§ä¼šä¸¢å¤±ï¼Œéœ€è¦ç”¨`toRefs`åŒ…è£¹ã€‚å¼•ç”¨ç±»å‹ç›´æ¥æ”¹å˜å¼•ç”¨åœ°å€ä¹Ÿä¼šå¯¼è‡´å“åº”å¼ä¸¢å¤±

#### ç›¸å…³ api

- `readonly` å°† reactive çš„å€¼æ›´æ”¹ä¸ºåªè¯»
- `shallowReactive` åªèƒ½å¯¹æµ…å±‚çš„æ•°æ®å“åº” å¦‚æœæ˜¯æ·±å±‚çš„æ•°æ®åªä¼šæ”¹å˜å€¼ ä¸ä¼šæ”¹å˜è§†å›¾

```
import { reactive, toRefs } from 'vue'

const book = reactive({
  author: 'Vue Team',
  year: '2020',
  title: 'Vue 3 Guide',
  description: 'You are reading this book right now ;)',
  price: 'free'
})

let { author, title } = toRefs(book)

title.value = 'Vue 3 Detailed Guide' // æˆ‘ä»¬éœ€è¦ä½¿ç”¨ .value ä½œä¸ºæ ‡é¢˜ï¼Œç°åœ¨æ˜¯ ref
console.log(book.title) // 'Vue 3 Detailed Guide'
```

### 3.4ã€ç”Ÿå‘½å‘¨æœŸ

åŒºåˆ«ä¸å¤§ï¼ŒæŠŠ setup å½“ created ç”¨ï¼Œå…¶å®ƒå°±å½“æ”¹äº†ä¸ªå

```
<script setup lang="ts">
import { onMounted } from 'vue';

const getUserInfo = () => {
  console.log('è·å–ç”¨æˆ·ä¿¡æ¯');
};
onMounted(getUserInfo);
</script>
```

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bdd4d01ec6794684ae46bfbfa96820c3~tplv-k3u1fbpfcp-watermark.image?)

### 3.5 watch & watchEffect

#### watch

- åŠŸèƒ½å’Œ vue2 ä¸€è‡´
- watch(ç›‘å¬å‚æ•°ï¼Œå˜åŒ–å›è°ƒï¼Œé…ç½®å‚æ•°)
- æ³¨æ„ç›‘å¬å¯¹è±¡çš„å•ä¸ªå±æ€§ï¼š`watch(() => articleInfo.author, (newVal) => {})`,ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç®­å¤´å‡½æ•°è¿”å›è¦ç›‘å¬çš„ç›®æ ‡å±æ€§

```
import { ref, reactive, watch } from 'vue'

const counter1 = ref(0)
const counter2 = ref(0)
// ç›‘å¬å¤šä¸ª
watch([counter1, counter2], (newValue, oldValue) => {
  console.log('The new counter1 value is: ' + counter1.value)
  console.log('The new counter2 value is: ' + counter2.value)
})

const obj = reactive({
  name: 'JJ',
  age: 18
})
// æ·±åº¦ç›‘å¬å¯¹è±¡
watch(obj, (newValue, oldValue) => {
  console.log('The new obj value is: ' + obj.value)
}, {
   deep: true,
   immediate: true
})
// watchç›‘å¬å•ä¸ªå±æ€§
watch(() => obj.name, (newValue, oldValue) => {
  console.log('The new obj value is: ' + obj.value)
}, {
   deep: true,
   immediate: true
})

```

#### watchEffect

- ç±»ä¼¼ React useEffectï¼Œä½†æ˜¯ä¸éœ€è¦å†™ä¾èµ–é¡¹ï¼Œåªè¦æˆ‘ä»¬å›è°ƒä¸­å¼•ç”¨äº†`å“åº”å¼çš„å±æ€§`
- å’Œ watch çš„åŒºåˆ«ï¼š
  - åŒä¸€ä¸ªåŠŸèƒ½çš„ä¸¤ç§ä¸åŒå½¢æ€ï¼Œåº•å±‚çš„å®ç°æ˜¯ä¸€æ ·çš„
  - watch å¯ä»¥è·å–åˆ°æ–°å€¼ä¸æ—§å€¼ï¼ˆæ›´æ–°å‰çš„å€¼ï¼‰ï¼Œè€Œ Â `watchEffect`Â  æ˜¯æ‹¿ä¸åˆ°çš„ã€‚
  - watch - `æ˜¾å¼`æŒ‡å®šä¾èµ–æºï¼ŒwatchEffect - `è‡ªåŠ¨`æ”¶é›†ä¾èµ–æº
  - watchEffect åœ¨ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™å°±ä¼šæ‰§è¡Œä¸€æ¬¡ç”¨ä»¥æ”¶é›†ä¾èµ–ï¼Œwatch æŒ‡å®šäº†ä¾èµ–ï¼Œæ‰€ä»¥ä¸éœ€è¦ã€‚
  - `å¯ä»¥ç†è§£ä¸ºwatchEffect å°±æ˜¯é…ç½®äº†{ immediate: true } çš„watch`
- ä½¿ç”¨åœºæ™¯ï¼š`antfuå°å“¥`ï¼šæ¨èåœ¨å¤§éƒ¨åˆ†æ—¶å€™ç”¨ watch æ˜¾å¼çš„æŒ‡å®šä¾èµ–ä»¥é¿å…ä¸å¿…è¦çš„é‡å¤è§¦å‘ï¼Œä¹Ÿé¿å…åœ¨åç»­ä»£ç ä¿®æ”¹æˆ–é‡æ„æ—¶ä¸å°å¿ƒå¼•å…¥æ–°çš„ä¾èµ–ã€‚watchEffect é€‚ç”¨äºä¸€äº›é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œä¾èµ–æºå’Œé€»è¾‘å¼ºç›¸å…³çš„åœºæ™¯ï¼ˆæˆ–è€…æ‡’æƒ°çš„åœºæ™¯ ï¼‰ã€‚

```js
const stopWatch = watchEffect(
  (oninvalidate): void => {
    oninvalidate(() => {
      console.log("å‰ç½®æ ¡éªŒå‡½æ•°");
    });
    // å¼•ç”¨äº†å“åº”å¼çš„å±æ€§ count
    console.log("watchEffect countå˜åŒ–", count.value);
  },
  {
    // å‰¯ä½œç”¨åˆ·æ–°æ—¶æœº flush ä¸€èˆ¬ä½¿ç”¨post
    // å¯é€‰ï¼špre(ç»„ä»¶æ›´æ–°å‰æ‰§è¡Œ)/sync(å¼ºåˆ¶æ•ˆæœå§‹ç»ˆåŒæ­¥è§¦å‘)/post(ç»„ä»¶æ›´æ–°åæ‰§è¡Œ)
    flush: "post",
    // å¼€å‘è°ƒè¯•
    onTrigger() {
      console.log("å¼€å‘è°ƒè¯•");
    },
  }
);
```

### 3.6 computed

- æ›´åŠ çµæ´»ï¼Œå¯ä»¥åœ¨å®šä¹‰å“åº”å¼å˜é‡æ—¶å£°æ˜
- ä½œç”¨å’Œ vue2 æ— å·®å¼‚

```
import { ref, computed } from 'vue'

const counter = ref(0)
const twiceTheCounter = computed(() => counter.value * 2)
// get setå†™æ³•
const plusOne = computed({
  get: () => counter.value + 1,
  set: (val) => {
    counter.value = val - 1
  },
})

plusOne.value = 1
console.log(counter.value) // 0

counter.value++
console.log(counter.value) // 1
console.log(twiceTheCounter.value) // 2
```

## å››ã€ç»„ä»¶

### 4.1 å¼‚æ­¥ç»„ä»¶

- é€šè¿‡è¿›è¡Œå¼•å…¥ defineAsyncComponent
- å¯é…åˆ Suspense è¿›è¡Œæ›´å¤šæ“ä½œï¼Œå¯ç”¨äº loading å’Œéª¨æ¶å±ç›¸å…³ï¼Œå’Œ react Suspense åŸºæœ¬ä¸€è‡´ã€‚ä¸è¿‡ react Suspense åŸºæœ¬ä¸€è‡´è¿™ä¸ªå±æ€§éƒ½ä¸å¤ªå¥½ç”¨ï¼Œvue çš„ä¸æ¸…æ¥šå®é™…åœºæ™¯å’‹æ ·

```js
// template
<Suspense>
  <template #default>
    <AsyncComponent></AsyncComponent>
  </template>

  <template #fallback>
    <div>loading...</div>
  </template>
</Suspense>

// script
const AsyncComponent = defineAsyncComponent(() => import('./asyncComponent.vue'))
```

### 4.2 Teleport ä¼ é€ç»„ä»¶

Teleport æ˜¯ä¸€ç§èƒ½å¤Ÿå°†æˆ‘ä»¬çš„æ¨¡æ¿æ¸²æŸ“è‡³æŒ‡å®š DOM èŠ‚ç‚¹ï¼Œä¸å—çˆ¶çº§ styleã€v-show ç­‰å±æ€§å½±å“ï¼Œä½† dataã€prop æ•°æ®ä¾æ—§èƒ½å¤Ÿå…±ç”¨çš„æŠ€æœ¯ï¼›ç±»ä¼¼äº `React çš„ Portal`ã€‚ä¹‹å‰å†™ react æ˜¯ä¸æ€ä¹ˆç”¨è¿™ä¸ªå±æ€§ï¼Œvue3 è¿™ä¸ªä¼°è®¡ä¹Ÿæ²¡å¤šå¤§ç”¨ã€‚

ä¸»è¦è§£å†³çš„é—®é¢˜ å› ä¸º Teleport èŠ‚ç‚¹æŒ‚è½½åœ¨å…¶ä»–æŒ‡å®šçš„ DOM èŠ‚ç‚¹ä¸‹ï¼Œå®Œå…¨ä¸å—çˆ¶çº§ style æ ·å¼å½±å“

to å±æ€§ æ’å…¥æŒ‡å®šå…ƒç´ ä½ç½®ï¼Œbodyï¼Œhtmlï¼Œè‡ªå®šä¹‰ className ç­‰ç­‰

```js
<Teleport to="body">
  <Loading></Loading>
</Teleport>
```

### 4.3 keep-alive ç¼“å­˜ç»„ä»¶

- ä½œç”¨å’Œ vue2 è¿˜æ˜¯ä¸€æ ·çš„ï¼Œç”Ÿå‘½å‘¨æœŸåç§°å˜äº†
- åˆæ¬¡è¿›å…¥æ—¶ï¼šonMounted> onActivated
- é€€å‡ºåè§¦å‘ deactivated
- å†æ¬¡è¿›å…¥ï¼šåªä¼šè§¦å‘ onActivated

### 4.4 ç»„ä»¶é€šä¿¡

#### defineXxxx

> defineXxxx æ— éœ€ import å³å¯ç›´æ¥ä½¿ç”¨

- defineProps ä»£æ›¿è¿‡å»çš„ props
- defineEmits ä»£æ›¿è¿‡å»çš„\$emit
- defineOptions è‡ªå®šä¹‰ä¸€äº›ç»„ä»¶å±æ€§ï¼Œæ¯”å¦‚ç»„ä»¶åç§°ï¼ˆéœ€è¦æ’ä»¶æ”¯æŒï¼‰
- defineComponent ç”¨äº render å‡½æ•°ã€TSXã€IDE æé†’ç­‰
- defineExpose å­ç»„ä»¶å£°æ˜çš„æ•°æ®ï¼Œæš´éœ²ç»™çˆ¶ç»„ä»¶ç›´æ¥ç”¨

#### provide/inject

å’Œ vue2 ä¸€è‡´

#### vuex & pina

> ä¸¤è€…ç”¨æ³•ï¼Œé™¤äº† pina æ²¡æœ‰ Mutationsï¼Œå·®åˆ«ä¸å¤§ã€‚ä½†æ˜¯å®˜æ–¹æ¨èçš„ä¸œè¥¿ï¼Œè‡ªç„¶æœ‰å®ƒçš„å„ç§ä¼˜ç‚¹

- Vuexï¼š Stateã€Gettesã€Mutations(åŒæ­¥)ã€Actions(å¼‚æ­¥)
- Piniaï¼š Stateã€Gettesã€Actions(åŒæ­¥å¼‚æ­¥éƒ½æ”¯æŒ)
- Vuex4 ç”¨äº Vue3 ï¼ŒVuex3 ç”¨äº Vue2
- Pinia2.x å³æ”¯æŒ Vue2 ä¹Ÿæ”¯æŒ Vue3

## äº”ã€TS æ”¯æŒ

- å¯ä»¥è®©å†™ react çš„å…„å¼Ÿï¼Œå¿«é€Ÿä¸Šæ‰‹å†™ vue3
- react ä¸­ {{}} => {}
- å…¼å®¹çš„æŒ‡ä»¤ï¼šv-modelï¼Œv-ifï¼Œv-show

```js
import { ref } from "vue";
let v = ref < string > "";
const renderDom = () => {
  return (
    <>
      <input v-model={v.value} type="text" />
      <div>{v.value}</div>
    </>
  );
};
export default renderDom;
```

## å…­ã€æ’ä»¶

### 6.1 å¼€æºæ’ä»¶

#### unplugin-auto-import/vite

æ— éœ€å¯¼å…¥ xxxï¼Œ`import { reactive,ref } from "vue";`ï¼Œåªéœ€è¦ç”¨å³å¯

#### unplugin-vue-define-options

è‡ªå®šä¹‰ç»„ä»¶åç§°ï¼Œéœ€è¦å¼•å…¥æ’ä»¶`unplugin-vue-define-options`,å¹¶åœ¨ vite ä¸­é…ç½®

```js
import { defineConfig } from "vite";
import vue from "@vitejs/plugin-vue";
import DefineOptions from "unplugin-vue-define-options/vite";

export default defineConfig({
  plugins: [vue(), DefineOptions()],
});
```

ä¸ä½¿ç”¨æ’ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¤šå†™ä¸€ä¸ª script æ ‡ç­¾æ¥å•ç‹¬å†™ options

```js
<script lang="ts">
    export default {
        name: "TButton",
    };
</script>
<script lang="ts" setup>
  defineOptions({
    name: 'TButton',
  });
</script>
```

### 6.2 vscode æ’ä»¶

#### volar vscode

- vetur åªæ”¯æŒ vue2ï¼Œvolar åªæ”¯æŒ vue3ï¼Œä¸¤è€…å†²çªã€‚
- å»ºè®®ç¦ç”¨ veturï¼Œæ ¼å¼åŒ–ä»£ç ä½¿ç”¨ prettierï¼Œæœ¬åœ°ä½¿ç”¨ volar åšä»£ç é«˜äº®ã€‚
- æˆ–è€…é€šè¿‡é¡¹ç›®é…ç½®ï¼ŒæŒ‡å®šç›¸å…³æ’ä»¶é…ç½®
  ![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fb86434ae5e1431faeb4b392e2f81359~tplv-k3u1fbpfcp-watermark.image?)

## ä¸ƒã€æŒ‡ä»¤

### 7.1 v-model

- åº•å±‚è¯­æ³•ç³–æ—¶é—´æ”¹å˜ï¼Œä¹‹å‰ vue2 æ˜¯ update:inputï¼Œvue3 æ˜¯ update:modelValue
- æ”¯æŒå¤šä¸ª v-model
- æ”¯æŒè‡ªå®šä¹‰ä¿®é¥°ç¬¦
- å¼ƒç”¨.sync ç­‰

### 7.2 è‡ªå®šä¹‰æŒ‡ä»¤

#### ç”Ÿå‘½å‘¨æœŸï¼ˆå’Œ vue3 ä¸€è‡´ï¼‰

- created å…ƒç´ åˆå§‹åŒ–çš„æ—¶å€™
- beforeMount æŒ‡ä»¤ç»‘å®šåˆ°å…ƒç´ åè°ƒç”¨ åªè°ƒç”¨ä¸€æ¬¡
- mounted å…ƒç´ æ’å…¥çˆ¶çº§ dom è°ƒç”¨
- beforeUpdate å…ƒç´ è¢«æ›´æ–°ä¹‹å‰è°ƒç”¨
- update è¿™ä¸ªå‘¨æœŸæ–¹æ³•è¢«ç§»é™¤ æ”¹ç”¨ updated
- beforeUnmount åœ¨å…ƒç´ è¢«ç§»é™¤å‰è°ƒç”¨
- unmounted æŒ‡ä»¤è¢«ç§»é™¤åè°ƒç”¨ åªè°ƒç”¨ä¸€æ¬¡

#### è‡ªå®šä¹‰æ‹–æ‹½æŒ‡ä»¤ v-move

- æ¯”å¦‚è¿™ä¸ª v-move å°è£…è‡ªå®šä¹‰æ‹–æ‹½æŒ‡ä»¤

```js
import { Directive } from "vue";
const vMove: Directive = {
  mounted(el: HTMLElement) {
    let moveEl = el.firstElementChild as HTMLElement;
    const mouseDown = (e: MouseEvent) => {
      //é¼ æ ‡ç‚¹å‡»ç‰©ä½“é‚£ä¸€åˆ»ç›¸å¯¹äºç‰©ä½“å·¦ä¾§è¾¹æ¡†çš„è·ç¦»=ç‚¹å‡»æ—¶çš„ä½ç½®ç›¸å¯¹äºæµè§ˆå™¨æœ€å·¦è¾¹çš„è·ç¦»-ç‰©ä½“å·¦è¾¹æ¡†ç›¸å¯¹äºæµè§ˆå™¨æœ€å·¦è¾¹çš„è·ç¦»
      console.log(e.clientX, e.clientY, "-----èµ·å§‹", el.offsetLeft);
      let X = e.clientX - el.offsetLeft;
      let Y = e.clientY - el.offsetTop;
      const move = (e: MouseEvent) => {
        el.style.left = e.clientX - X + "px";
        el.style.top = e.clientY - Y + "px";
        console.log(e.clientX, e.clientY, "---æ”¹å˜");
      };
      document.addEventListener("mousemove", move);
      document.addEventListener("mouseup", () => {
        document.removeEventListener("mousemove", move);
      });
    };
    moveEl.addEventListener("mousedown", mouseDown);
  },
};
```

## å…«ã€Hook

ç”¨äº† react hook çš„äººéƒ½çŸ¥é“å¾ˆé¦™ï¼Œvue3 æ”¯æŒè¿™ä¸ªç›¸å½“ä¸é”™ï¼Œèƒ½è§£å†³å¾ˆå¤šä¸šåŠ¡åœºæ™¯çš„å°è£…

### 8.1 è‡ªå®šä¹‰ Hook

å¯ä»¥å½“åš mixins å†™

```js
// useWindowResize
import { onMounted, onUnmounted, ref } from "vue";

function useWindowResize() {
  const width = ref(0);
  const height = ref(0);
  function onResize() {
    width.value = window.innerWidth;
    height.value = window.innerHeight;
  }
  onMounted(() => {
    window.addEventListener("resize", onResize);
    onResize();
  });
  onUnmounted(() => {
    window.removeEventListener("resize", onResize);
  });

  return {
    width,
    height,
  };
}

export default useWindowResize;
```

### 8.2 hook åº“

- [vueuse](https://github.com/vueuse/vueuse) å®˜æ–¹ï¼Œæ„Ÿè°¢è¯„è®ºåŒº[@rogepi](https://juejin.cn/user/3438928104002856) å°å“¥çš„æé†’
- [ahooks-vue](https://dewfall123.github.io/ahooks-vue/)
- [v3hooks](https://github.com/yanzhandong/v3hooks)

### 8.3 react vs vue3

- [Vue3 ç©¶ç«Ÿå¥½åœ¨å“ªé‡Œï¼Ÿï¼ˆå’Œ React Hook çš„è¯¦ç»†å¯¹æ¯”ï¼‰ssh-æ™¨æ›¦æ—¶æ¢¦è§å…®](https://zhuanlan.zhihu.com/p/133819602)  
  ![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b1edbef1b8c740af9d6655035157ec42~tplv-k3u1fbpfcp-watermark.image?)

## ä¹ã€ç»“è¯­

- Vue3 çš„ä¾èµ–è¿½è¸ªæ˜¯å…¨è‡ªåŠ¨çš„ï¼Œä¸éœ€è¦æ‹…å¿ƒä¼ äº†é”™è¯¯çš„ä¾èµ–æ•°ç»„ç»™ useEffect/useMemo/useCallback ä»è€Œå¯¼è‡´å›è°ƒä¸­- ä½¿ç”¨äº†è¿‡æœŸçš„å€¼
- Vue3 Hook ä¹Ÿæ²¡ React Hook é‚£ä¹ˆå¤šé™åˆ¶ï¼Œåç»­ç”¨ç”¨çœ‹æ€ä¹ˆæ ·
- ä¸ªäººæ¯”è¾ƒå–œæ¬¢ SFC è¯­æ³•ï¼Œhtmlã€jsã€css åˆ†ç¦»å¼€

> ç¬”è€… vue3 ä¹Ÿåˆšç”¨ä¸ä¹…ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œè¿˜è¯·å…„å¼Ÿä»¬æŒ‡å‡º

æœ¬æ–‡æ‰€æœ‰ demo éƒ½åœ¨è¯¥ä»“åº“ä¸­[JJ-UI ä¸€æ¬¾ Vue3 ç»„ä»¶åº“](https://github.com/alexwjj/jj-ui)ï¼Œå‚è€ƒå¤§ä½¬æ–‡ç« åˆšåˆšæ­å»ºå¥½ï¼Œåç»­ä¼šåŸºäºè¿™ä¸ªæ¶å­å¼€å‘è‡ªå·±çš„ vue3 ç»„ä»¶åº“

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8003d0ab1b2540cdb5cb2e7b2461dbcd~tplv-k3u1fbpfcp-watermark.image?)

## åã€å‚è€ƒæ–‡ç« 

- [å°æ»¡ zs vue3 è®²è§£ç³»åˆ— B ç«™æœ‰è§†é¢‘](https://blog.csdn.net/qq1195566313/category_11618172.html?spm=1001.2014.3001.5482)
- [Vue3.0 ä¸­ Ref ä¸ Reactive çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ](https://www.yisu.com/zixun/604877.html)
- [vue3.0 çš„ä¼˜åŒ–](https://blog.csdn.net/weixin_47450807/article/details/123478024)
- [ï¼ˆå»ºè®®æ”¶è—ï¼‰Vue3 å¯¹æ¯” Vue2.x å·®å¼‚æ€§ã€æ³¨æ„ç‚¹ã€æ•´ä½“æ¢³ç†ï¼Œä¸ React hook æ¯”åˆå¦‚ä½•ï¼Ÿï¼ˆé¢è¯•çƒ­ç‚¹ï¼‰](https://juejin.cn/post/6892295955844956167)
- [ä¸ºä»€ä¹ˆ Vue3 çš„ ref è®©å¾ˆå¤šå¤§ä½¬æ“ç¢äº†å¿ƒï¼Ÿ](https://juejin.cn/post/6895213945997492238)

## åä¸€ã€å¾€æœŸæ¨è

- [èŠä¸€èŠ web å›¾ç‰‡å°çŸ¥è¯† ](https://juejin.cn/post/7116715255404691493/) 50+ ğŸ‘ğŸ¿
- [ã€é€ƒç¦»ä¸€çº¿ã€‘è¢«è£åçš„é¢ç»ä¸æ„Ÿæ…¨](https://juejin.cn/post/7098173433548111885) 350+ ğŸ‘ğŸ¿
- [ä¸€ç¯‡æå®šã€web æ‰“å°ã€‘çŸ¥è¯†ç‚¹](https://juejin.cn/post/6985030118758416391) 90+ ğŸ‘ğŸ¿
- [ä¸€ç¯‡å¤Ÿç”¨çš„ TypeScript æ€»ç»“](https://juejin.cn/editor/drafts/6979800157164404767) 800+ ğŸ‘ğŸ¿
- [ä¸€å vueCoder æ€»ç»“çš„ React åŸºç¡€](https://juejin.cn/post/6960556335092269063) 240+ ğŸ‘ğŸ¿
- [Vue è½¬ React ä¸å®Œå…¨æŒ‡åŒ—](https://juejin.cn/post/6953482028188860424) 900+ ğŸ‘ğŸ¿
- [è·³æ§½äººé€Ÿæ¥ï¼Œé¢ç»&èµ„æºåˆ†äº«](https://juejin.cn/post/6942988170208215076) 1300+ ğŸ‘ğŸ¿
- [ä¸€å¹´åŠå‰ç«¯äººçš„æ±‚èŒè·¯](https://juejin.cn/post/6940058373534515237) 350+ ğŸ‘ğŸ¿
- [vue2.x é«˜é˜¶é—®é¢˜ï¼Œä½ èƒ½ç­”å¤šå°‘](https://juejin.cn/post/6921911974611664903) 500+ ğŸ‘ğŸ¿
- [èŠä¸€èŠå‰ç«¯æ€§èƒ½ä¼˜åŒ–](https://juejin.cn/post/6921911974611664903) 1700+ ğŸ‘ğŸ¿
- [Egg + Puppeteer å®ç° Html è½¬ PDF(å·²å¼€æº)](https://juejin.cn/post/6907500437134376974) 70+ ğŸ‘ğŸ¿

## åäºŒã€æ±‚èµã€æ±‚ä¸‰è¿

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9a5788cc8d694af3beac8fd0a885b02e~tplv-k3u1fbpfcp-watermark.image?)

æˆ‘æ­£åœ¨å‚ä¸æ˜é‡‘æŠ€æœ¯ç¤¾åŒºåˆ›ä½œè€…ç­¾çº¦è®¡åˆ’æ‹›å‹Ÿæ´»åŠ¨ï¼Œ[ç‚¹å‡»é“¾æ¥æŠ¥åæŠ•ç¨¿](https://juejin.cn/post/7112770927082864653)ã€‚
